#!/bin/bash
#
# Sparrow Browser - Herramienta de Desarrollo
#

GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m'

case "$1" in
    run|r)
        echo -e "${BLUE}Ejecutando Sparrow...${NC}"
        ./sparrow
        ;;
    
    test|t)
        echo -e "${BLUE}Ejecutando tests de coordinación...${NC}"
        ./gradlew test --tests CoordinationIntegrationTest
        ./gradlew test --tests CoordinationWorkflowTest.testFeeProposalReplacement
        ;;
    
    build|b)
        echo -e "${BLUE}Compilando proyecto...${NC}"
        ./gradlew build
        ;;
    
    jpackage|j|pkg)
        echo -e "${BLUE}Creando binario jpackage...${NC}"
        ./gradlew clean jpackage
        ;;
    
    quick|q)
        echo -e "${BLUE}Build rápido + ejecutar...${NC}"
        ./gradlew compileJava && ./gradlew jpackage && ./sparrow --quiet
        ;;
    
    clean|c)
        echo -e "${BLUE}Limpiando build...${NC}"
        ./gradlew clean
        ;;
    
    commit)
        echo -e "${BLUE}Hacer commit${NC}"
        read -p "Mensaje: " msg
        git add .
        git commit -m "$msg"
        echo -e "${GREEN}✅ Commit realizado${NC}"
        ;;
    
    push|p)
        echo -e "${BLUE}Push a origin/master${NC}"
        git push origin master
        echo -e "${GREEN}✅ Push completado${NC}"
        ;;
    
    status|s)
        echo -e "${YELLOW}=== Git Status ===${NC}"
        git status -sb
        echo ""
        echo -e "${YELLOW}=== Últimos Commits ===${NC}"
        git log --oneline -5
        ;;
    
    help|h|*)
        echo "Sparrow Browser - Herramienta de Desarrollo"
        echo ""
        echo "Uso: ./dev <comando>"
        echo ""
        echo "Comandos disponibles:"
        echo -e "  ${GREEN}run, r${NC}          Ejecutar Sparrow"
        echo -e "  ${GREEN}test, t${NC}         Ejecutar tests de coordinación"
        echo -e "  ${GREEN}build, b${NC}        Compilar proyecto"
        echo -e "  ${GREEN}jpackage, j${NC}     Crear binario jpackage"
        echo -e "  ${GREEN}quick, q${NC}        Build rápido + ejecutar"
        echo -e "  ${GREEN}clean, c${NC}        Limpiar archivos compilados"
        echo -e "  ${GREEN}commit${NC}          Hacer commit interactivo"
        echo -e "  ${GREEN}push, p${NC}         Push a origin/master"
        echo -e "  ${GREEN}status, s${NC}       Ver estado de git"
        echo -e "  ${GREEN}help, h${NC}         Mostrar esta ayuda"
        echo ""
        echo "Ejemplos:"
        echo "  ./dev run       # Ejecutar Sparrow"
        echo "  ./dev test      # Ejecutar tests"
        echo "  ./dev quick     # Build rápido y ejecutar"
        echo ""
        ;;
esac
